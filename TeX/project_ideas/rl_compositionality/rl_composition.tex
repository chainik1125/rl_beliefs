\documentclass[12pt]{article}
\usepackage{amssymb,amsfonts,amsmath, amsthm, amsbsy}
\usepackage{caption,color,graphicx,paralist, subcaption, placeins, array, mathtools, url, mdwlist, color,tikz} 
\usepackage[text={6.75in,9.5in},centering,letterpaper]{geometry}
\usepackage[linktoc=all,hypertexnames=false,colorlinks=true,urlcolor=blue,linkcolor=blue,citecolor=blue]{hyperref}
\usepackage[shortlabels]{enumitem}
\usetikzlibrary{decorations.pathmorphing, calc, arrows.meta}
\newcommand*\dif{\mathop{}\!\mathrm{d}}
\usepackage{setspace}

\DeclarePairedDelimiter\bra{\langle}{\rvert}
\DeclarePairedDelimiter\ket{\lvert}{\rangle}
\DeclarePairedDelimiterX\braket[2]{\langle}{\rangle}{#1 \delimsize\vert #2}

\setlength{\parskip}{1.0ex plus0.2ex minus0.2ex}
\setlength{\parindent}{0.0in}
\renewcommand{\baselinestretch}{1.2}
\renewcommand*{\arraystretch}{1.5}
\everymath={\displaystyle}
\numberwithin{equation}{section}

\usepackage[thinc]{esdiff}
\renewcommand{\Re}[1]{\text{\textit{Re}}[#1]}
\renewcommand{\Im}[1]{\text{\textit{Im}}[#1]}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\F}{\mathbb{F}}

\newtheorem{Theorem}{Theorem}[section]
\newtheorem{Conjecture}[Theorem]{Conjecture}
\newtheorem{Lemma}[Theorem]{Lemma}
\newtheorem{Proposition}[Theorem]{Proposition}
\newtheorem{Corollary}[Theorem]{Corollary}
\newtheorem{Example}[Theorem]{Example}
\newtheorem{Definition}[Theorem]{Definition}
\newtheorem*{Notation}{Notation}
\newtheorem{Remark}[Theorem]{Remark}
\newtheorem{Assumption}{Assumption}

\newenvironment{exercise}[2][]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{ppart}[2][]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

\newtheorem*{strategy}{Strategy}
\newcommand{\pd}[3]{\bigg(\frac{\partial #1}{\partial #2}\bigg)_{#3}}
\newcommand{\funcd}[3]{\bigg(\frac{\delta #1}{\delta #2}\bigg)_{#3}}
\usepackage{cleveref}
\usepackage{braket}
\usepackage{slashed}
\DeclareMathOperator{\sech}{sech}
\usepackage{dsfont}
\usepackage{cancel}
\usepackage{xcolor}
\newcommand\Ccancel[2][black]{\renewcommand\CancelColor{\color{#1}}\cancel{#2}}
\usepackage{simpler-wick}
\DeclareMathOperator{\Tr}{Tr}
\usepackage[gobble=auto]{pythontex}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{xfp}
\usepackage{calc}
\usepackage[nomessages]{fp}
\usepackage{subfiles}

\NewExpandableDocumentCommand{\bettersquareroot}{O{16}m}{%
  \fpeval{round(sqrt(#2),#1)}%
}

% === Dmitry addition for solution boxes ===
% \usepackage[most]{tcolorbox}
% \newtcolorbox{solnbox}{colback=gray!10,colframe=gray!60,boxrule=0.5pt,arc=2pt,
%   left=8pt,right=8pt,top=6pt,bottom=6pt}



\title{Composing belief states in RL}
\date{}

\begin{document}
\maketitle
\section{Motivation/ToC}
Current safety alignment is critically reliant on \textit{post}-training. Post-training, in turn, is largely based on reinforcement learning. Moreover, this reliance has increased with the advent of inference-time scaling and is likely to increase further. 

For our interpretability tools to be relevant, they therefore have to deal with this paradigm. There are however, no clearly understood models of reinforcement learning. 

\section{Basic idea}

We want to study how belief states change under reinforcement learning. Although there are a number of different setups in which to do this, the one that seemed to be most concrete to me is studying compositionality under RL. In particular, given a pre-trained model that has learned different skills, we want to understand how they are combined together to form new skills under RL. Our basic question is:

``Can we detect when RL is composing belief states into something novel vs. merely reweighting them?''

\section{Simple example}
A very simple example could be logical operations. The IMPLIES conditional is equivalent to a combination of NOT and AND operations. This means we could study a case in which:
\begin{enumerate}
    \item We pre-train a model on a HMM simultating noisy AND, and probe for the belief state.
    \item We pre-train a model on the HMM simulating noise NOT, and probe for the belief state. We should expect that the
    \item We make the reward function the results of applying IMPLIES and RL train the
\end{enumerate}
This example is too simple to actually work, so a slightly more complicated case could be:
\begin{enumerate}
    \item Pre-train 1: Train on Mess3
    \item Pre-traing 2: Train on another Mess process or RRXOR.
    \item Post-train: Train on a value function that requires the composition of both.
\end{enumerate}

\section{Safety relevance}
There are a number of safety relevant applications that could arise from this toy model.

\begin{enumerate}
    \item Capability auditing:\\
    Can we find belief state signatures for when a model acquires a genuinely new capability vs when it is eliciting existing capabilities?
    \item Alignment robustness/Emergent misalignment:\\
     Emergent misalignment arises because alignment seems to be a general concept rather than particular to each misalignment instance. This may mean that we can identify misalignment as a 'factored' belief state that can be easily accessed. If this is true, it should make emergent misalignment easy to turn on/off (already the case via steering vectors, but we want to see if we can find a mechanistic understanding of why it is easy to access). We can then study whether other RL processes can make misalignment harder to access.
    \item Model Personas: \\
    Can we think of personas as different elements that can be composed via RL? If so, can we study how RL changes the model persona?
\end{enumerate}

\section{Alternative settings for belief states in RL}
\begin{enumerate}
    \item Chain-of-thought monitoring: Can we use belief states to help detect when a model is doing unfaithful reasoning?\\
    Do we have a good toy model for chain of thought reasoning?
    
    \item Steganography: Similar to the above, can we use belief states to help us identify steganography?
    \item Rare capabilities in RL: We could study a factored belief process in which one of the factors appears only when a certain token is observed for the other process. If we allow the model to select which token it sees, it should be able to observe the rarer process. We can use this as a model for how RL can access rare behaviour in LLMs.
\end{enumerate}

% \section{Alternative project ideas}
% \begin{enumerate}
%     \item Can we study how belief states change under CoT prompting generally?
%     \item 
% \end{enumerate}

\subfile{emergent_misalignment}

\bibliographystyle{alpha}
\bibliography{refs}

\end{document}
